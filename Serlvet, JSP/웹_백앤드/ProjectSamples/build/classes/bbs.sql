drop table BBS;

CREATE TABLE BBS(
	SEQ INT AUTO_INCREMENT PRIMARY KEY,
	ID VARCHAR(50) NOT NULL,
	
	REF DECIMAL(8) NOT NULL,	-- 0
	STEP DECIMAL(8) NOT NULL,	-- 0
	DEPTH DECIMAL(8) NOT NULL,	-- 0
	
	TITLE VARCHAR(200) NOT NULL,
	CONTENT VARCHAR(4000) NOT NULL,
	WDATE TIMESTAMP NOT NULL,
	
	DEL DECIMAL(1) NOT NULL,	-- 0
	READCOUNT DECIMAL(8) NOT NULL -- 0
);

-- DATA: INSERT DELETE SELECT UPDATE
-- OBJECT(TABLE): CREATE ALTER DROP

ALTER TABLE BBS
ADD
FOREIGN KEY(ID) REFERENCES MEMBER(ID);

INSERT INTO BBS(ID, REF, STEP, DEPTH, TITLE, CONTENT, WDATE, DEL, READCOUNT)
VALUES('abc', (SELECT IFNULL(MAX(REF), 0)+1 FROM BBS a), 0, 0, 
		'제목입니다', '내용입니다', NOW(), 0, 0);

SELECT * FROM BBS;		
		
-- IFNULL(컬럼, 값)

SELECT * 
FROM BBS;

-- 번호를 할당 ROW_NUMBER()
SELECT SEQ, ID, REF, STEP, DEPTH, TITLE, CONTENT, WDATE, DEL, READCOUNT
FROM
	(SELECT ROW_NUMBER()OVER(ORDER BY REF DESC, STEP ASC) AS RNUM, 
		SEQ, ID, REF, STEP, DEPTH, TITLE, CONTENT, WDATE, DEL, READCOUNT
	FROM BBS
	ORDER BY REF DESC, STEP ASC) A
WHERE RNUM BETWEEN 1 AND 10;

CREATE TABLE MEMBER(
	ID VARCHAR(50) PRIMARY KEY, 
	PWD VARCHAR(50) NOT NULL,
	NAME VARCHAR(50) NOT NULL,
	EMAIL VARCHAR(50) UNIQUE,
	AUTH INT NOT NULL
);